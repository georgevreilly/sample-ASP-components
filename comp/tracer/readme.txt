                      Tracer Component
                      ================


Table of Contents
=================

    Overview
    Installation
    File List
    Sample ASP
    Build Notes
    Support
    Data Format
    Discussion of the Design
    Change Notes


Overview
========

The Tracer is a poor man's profiler for ASP pages.  It acts as a stop watch
that clients can start, stop, split, etc.  It also can simply output strings.
All data is output to the debug log, but this could easily be
changed to ouput to a file.  The data is formated as a comma-separated list,
so it can be imported into your favorite database/spreadsheet for saving and
manipulation

Installation
============

In order to use this component you must register it.  This will allow Active
Server Pages (ASP) Scripting Languages and other languages to make use of
the component.  ASP uses either the Server.CreateObject("ObjectName") syntax
or the <object id="myName" progid="ObjectName" runat="server"> syntax to
gain access to an object.  New objects can be made ready for use by
installing a new component.  Note: One component may contain more than one
object definition.

The following directions are to help you register the component for use:
 1. Use the Start menu, Programs option to start a Command Prompt
 2. Type the following:
	cd \InetPub\ASPSamp\Components\tracer\DLL\i386
 3. Type:
	regsvr32 tracer.dll
Note: you must register the component on each IIS server where you intend
to use it.

If you have trouble registering components, you may be using the wrong
version of RegSvr32.exe.  Please use the version installed by default in
the directory <InstallDir>\ASP\Cmpnts.  On Windows NT, the default
installation directory is \winnt\System32\Inetsrv.  On Windows 95, it is
\Program Files\WebSvr\System.

(If you rebuild the source code, the makefile will automatically reregister
the component for you.)

The following directions are to help you test the registered component:
 1. Copy everything from \inetpub\ASPSamp\Components\Tracer\Samples to
    \InetPub\ASPSamp\Samples.
 2. Run dbmon.exe (installed with devstudio).
 3. In your browser, open http://localhost/ASPSamp/Samples/tracer.asp


File List
=========

File             Description
----             -----------

.\Source

 TraceObj.cpp    the C++ source code for the tracer component
 TraceObj.h      declarations for CTracer
 Tracer.idl      declaration of ITracer, the IDispatch-based interface
 Makefile        a makefile that can be used with nmake
 Tracer.mak      the Developer Studio makefile
 Tracer.cpp      )
 Tracer.def      )
 Tracer.mdp      )
 Tracer.rc       > Generated by the ATL COM AppWizard
 Resource.h      )
 StdAfx.cpp      )
 StdAfx.h        )

.\Samples

 tracer.asp      ASP file demonstrating the Tracer


Samples
=======


Build Notes
===========

This sample requires Microsoft Visual C++ 5.0 or newer and ATL version
2.1 installed with it.

If you get an error about "don't know how to make asptlb.h", you will
need to copy <InstallDir>\ASP\Cmpnts\AspTlb.h to your include
directory.

Finally you must have the lastest version of MS Transaction Server
installed (part of IIS 4.0).  Add the include path and library path
of MTX before any system directories under Tools:Options....  So your
include path might look like this: c:\program files\mts\include;
c:program files\devstudio\vc\include;... (depending on where you have
installed MTX).  If you intend to build from the command line, you
must edit vcvars32.bat accordingly as well.

You can build this component with nmake at the command line.  Read
Makefile for more details.  You can also build it in Microsoft
Developer Studio, using the ContRot.dsp project.

The component can be built as ANSI or Unicode.  If you intend to
run it on Windows 95, build it as ANSI.  If you build it as a
Unicode DLL, all data files will need to be in Unicode format.


Support
=======

This component is not officially supported by Microsoft Corporation.
Peer support is available on the Active Server Pages mailing list or on
the microsoft.public.inetserver.iis.activeserverpages newsgroup.

To subscribe to the Active Server Pages mailing list, send mail to
listserv@listserv.msn.com with

subscribe ActiveServerPages [firstname lastname]

in the body of the message, and then follow the directions carefully.
(firstname and lastname are optional.)

You can reach the newsgroup through msnews.microsoft.com and other NNTP
servers.


Discussion of the Design
========================

The tracer is meant as a poor man's profiling component for ASP.  The
output simply goes to the debug stream right now (OuputDebugString),
but this can easily be changed to log to a file or whatever you choose.
The output is formated as a comma separated list, so you can cut and
paste it into another application (Excel or Access) to preserve your
result.

This component actually doesn't need any of the ASP instrinsic objects
(Application, Server, etc), so it could be used in any script you wanted
to profile.

Change Notes
============

Version 1.0 Beta 1: September 1997
----------------------------------

First release.

